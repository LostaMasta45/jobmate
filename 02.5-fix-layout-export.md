Perbaiki tampilan **preview**, **print/PDF**, dan **Word** agar:

* Ukuran kertas **A4 (210×297 mm)** dengan **margin 25 mm** (2.5 cm).
* **Font 12 pt** (Times New Roman atau system serif), **line-height 1.5**.
* **Paragraf rata kiri–kanan (justify)**.
* Jarak spasi antar bagian konsisten: heading, salam, paragraf, daftar lampiran, tanda tangan.
* Bagian **Data Pribadi** (atau data diri) memakai **tabel 3 kolom**: *label* | `:` | *nilai* → **titik dua sejajar**.
* PDF dari **html2pdf.js** dan DOCX dari **docx.js** mengikuti spesifikasi di atas.

---

## 🧩 Perubahan Komponen

### 1) `PreviewSurat.tsx`

* Bungkus isi surat dengan **container A4** dan gunakan gaya tipografi standar.

```tsx
// PreviewSurat.tsx (cuplikan)
export default function PreviewSurat({ text, data }: { text: string; data: FormState }) {
  const content = useMemo(() => replacePlaceholders(text, data), [text, data])

  return (
    <div className="a4-wrap">
      <div id="preview-surat" className="a4-page">
        {/* Header tanggal/kota, salam pembuka, isi, dsb. */}
        {/* Untuk bagian Data Pribadi gunakan komponen KeyValueTable (di bawah). */}
        <Letter content={content} data={data} />
      </div>
    </div>
  )
}
```

> **Catatan:** Jangan render semua sebagai `innerText` mentah. Untuk menjaga rata dan “:” sejajar, **pecah** bagian *Data Pribadi* menjadi tabel terstruktur.

---

### 2) **Komponen Tabel Label–Nilai** (titik dua sejajar)

Buat komponen agar semua template bisa memanggilnya saat butuh “Data Pribadi”.

```tsx
// components/KeyValueTable.tsx
export function KeyValueTable(rows: Array<[label: string, value: string]>) {
  return (
    <table className="kv w-full">
      <tbody>
        {rows.map(([k, v], i) => (
          <tr key={i} className="align-top">
            <td className="kv-label">{k}</td>
            <td className="kv-sep">:</td>
            <td className="kv-value">{v || "—"}</td>
          </tr>
        ))}
      </tbody>
    </table>
  )
}
```

Di `Letter` component, ketika menemukan blok “Data Pribadi:” atau “Identitas:”, render dengan:

```tsx
<KeyValueTable rows={[
  ["Tempat/Tanggal Lahir", `${data.biodata.tempatLahir}, ${formatTanggalID(data.biodata.tanggalLahir)}`],
  ["Pendidikan", data.biodata.pendidikan],
  ["Status", data.biodata.status],
  ["Kontak", `${data.biodata.noHandphone}`],
  ["Email", data.biodata.email],
  ["Alamat", data.biodata.alamatLengkap],
]} />
```

> Jika suatu template tidak punya bagian “Data Pribadi”, biarkan seperti paragraf biasa.

---

### 3) **CSS A4 + Typography + Print**

Tambahkan util berikut (Tailwind + global CSS). Pastikan di-*import* 1× (mis. `globals.css`).

```css
/* === A4 layout & typography === */
.a4-wrap { display: flex; justify-content: center; }
.a4-page {
  width: 210mm;            /* A4 width */
  min-height: 297mm;       /* A4 height */
  padding: 25mm;           /* margin konten */
  background: #fff;
  color: #000;
  font-family: "Times New Roman", ui-serif, Georgia, Cambria, "Times", serif;
  font-size: 12pt;         /* standar surat */
  line-height: 1.5;
  letter-spacing: 0.1px;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

/* paragraf rapi */
.a4-page p { margin: 0 0 10pt 0; text-align: justify; }
.a4-page .section-gap { margin-top: 14pt; }
.a4-page .sign-gap { margin-top: 28pt; }

/* tabel label : nilai */
.kv { border-collapse: collapse; margin-top: 6pt; }
.kv-label { width: 42%; padding: 0 0 2pt 0; vertical-align: top; }
.kv-sep   { width: 12pt; padding: 0 0 2pt 0; text-align: center; }
.kv-value { width: 58%; padding: 0 0 2pt 0; }

/* daftar lampiran (numerik) */
.ol-tight { margin: 6pt 0 0 18pt; }
.ol-tight li { margin: 0 0 4pt 0; }

/* Print/A4 */
@page { size: A4; margin: 0; } /* margin 0 karena kita pakai padding 25mm di .a4-page */

@media print {
  body * { visibility: hidden !important; }
  #preview-surat, #preview-surat * { visibility: visible !important; }
  #preview-surat { position: absolute; inset: 0; }
}
```

> **Kenapa margin @page = 0?**
> Karena margin konten dikontrol oleh `padding: 25mm` di `.a4-page`. Ini membuat HTML2PDF & print punya area bersih yang konsisten.

---

### 4) **Struktur Paragraf yang Disarankan (Letter)**

Gunakan blok paragraf, bukan `<br>` berturut-turut.

```tsx
// components/Letter.tsx (skema)
export function Letter({ content, data }: { content: string; data: FormState }) {
  // Pisahkan bagian dengan regex (tanggal/kota, tujuan, perihal, salam, isi, data pribadi, lampiran, penutup, tanda tangan).
  // Untuk contoh cepat: render seperti di bawah; sesuaikan sesuai template aktif.
  return (
    <>
      <p>{`${data.perusahaan.kotaPerusahaan?.toUpperCase() || "—"}, ${formatTanggalID(data.perusahaan.tanggalLamaran)}`}</p>

      <div className="section-gap">
        <p>Kepada:</p>
        <p>{data.perusahaan.kepadaYth || "HRD"}</p>
        <p>{`${data.perusahaan.jenisInstansi ? data.perusahaan.jenisInstansi + " " : ""}${data.perusahaan.namaPerusahaan || "—"}`}</p>
      </div>

      <div className="section-gap">
        <p><strong>Perihal: </strong>{`Lamaran ${data.perusahaan.posisiLowongan || "Pekerjaan"}`}</p>
      </div>

      <div className="section-gap">
        <p>Dengan hormat,</p>
      </div>

      {/* Paragraf pembuka */}
      <p>
        {`Nama saya ${data.biodata.namaLengkap || "—"}, saat ini berdomisili di ${data.biodata.alamatKota || "—"}. Melalui surat ini, saya mengajukan lamaran untuk posisi ${data.perusahaan.posisiLowongan || "—"} di ${data.perusahaan.jenisInstansi ? data.perusahaan.jenisInstansi + " " : ""}${data.perusahaan.namaPerusahaan || "—"}.`}
      </p>

      {/* Data Pribadi sebagai tabel */}
      <div className="section-gap">
        <p><strong>Data Pribadi:</strong></p>
        <KeyValueTable rows={[
          ["Tempat/Tanggal Lahir", `${data.biodata.tempatLahir || "—"}, ${formatTanggalID(data.biodata.tanggalLahir)}`],
          ["Pendidikan", data.biodata.pendidikan],
          ["Status", data.biodata.status],
          ["Kontak", data.biodata.noHandphone],
          ["Email", data.biodata.email],
          ["Alamat", data.biodata.alamatLengkap],
        ]} />
      </div>

      {/* Sumber informasi */}
      <div className="section-gap">
        <p><strong>Sumber informasi:</strong> {data.perusahaan.sumberLowongan || "—"}</p>
      </div>

      {/* Lampiran */}
      <div className="section-gap">
        <p><strong>Lampiran:</strong></p>
        <ol className="ol-tight">
          {(data.perusahaan.lampiran?.length ? data.perusahaan.lampiran : ["—"]).map((v, i) => (
            <li key={i}>{v}</li>
          ))}
        </ol>
      </div>

      {/* Penutup */}
      <div className="section-gap">
        <p>{`Saya siap untuk bergabung dan memberikan kontribusi terbaik.`}</p>
      </div>

      <div className="section-gap">
        <p>Terima kasih atas perhatiannya.</p>
      </div>

      {/* Tanda tangan */}
      <div className="sign-gap">
        <p>Hormat saya,</p>
        <div style={{ height: "24pt" }} />
        <p>{data.biodata.namaLengkap || "—"}</p>
      </div>
    </>
  )
}
```

> **Penting:** Paragraf **justify** otomatis dari CSS `.a4-page p { text-align: justify }`.

---

## 🧾 Perbaikan Ekspor PDF (html2pdf.js)

```ts
async function handleDownloadPDF() {
  const html2pdf = (await import('html2pdf.js')).default
  const el = document.getElementById('preview-surat')!
  const filename = `Surat_Lamaran_${form.biodata.namaLengkap || "User"}.pdf`

  html2pdf()
    .set({
      filename,
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2, useCORS: true },
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
      pagebreak: { mode: ['css', 'legacy'] }
    })
    .from(el)
    .save()
}
```

* Pastikan **container** berkelas `.a4-page` (210 mm × 297 mm, padding 25 mm).
* `scale: 2` menjaga teks tetap tajam.

---

## 📘 Perbaikan Ekspor Word (docx.js)

* Gunakan **margins 25 mm** (≈ 1417 twips).
* **Font 12 pt**, align **JUSTIFIED**.
* Buat **table 3 kolom** untuk “Data Pribadi”.

```ts
import { AlignmentType, convertInchesToTwip, Document, HeadingLevel, Packer, Paragraph, Table, TableRow, TableCell, TextRun, WidthType } from "docx"
import { saveAs } from "file-saver"

async function handleDownloadWord(previewData: FormState) {
  const mmToTwip = (mm: number) => Math.round((mm / 25.4) * 1440)

  const doc = new Document({
    sections: [{
      properties: {
        page: {
          margin: {
            top: mmToTwip(25), right: mmToTwip(25), bottom: mmToTwip(25), left: mmToTwip(25)
          }
        }
      },
      children: [
        new Paragraph({ text: `${(previewData.perusahaan.kotaPerusahaan || "—").toUpperCase()}, ${formatTanggalID(previewData.perusahaan.tanggalLamaran)}`, spacing: { after: 200 } }),
        new Paragraph({ text: "Kepada:", spacing: { after: 0 } }),
        new Paragraph({ text: `${previewData.perusahaan.kepadaYth || "HRD"}`, spacing: { after: 0 } }),
        new Paragraph({ text: `${previewData.perusahaan.jenisInstansi ? previewData.perusahaan.jenisInstansi + " " : ""}${previewData.perusahaan.namaPerusahaan || "—"}`, spacing: { after: 200 } }),

        new Paragraph({ text: `Perihal: Lamaran ${previewData.perusahaan.posisiLowongan || "Pekerjaan"}`, spacing: { after: 200 }, bold: true }),

        new Paragraph({ text: "Dengan hormat,", spacing: { after: 200 } }),

        new Paragraph({
          children: [ new TextRun({
            text: `Nama saya ${previewData.biodata.namaLengkap || "—"}, saat ini berdomisili di ${previewData.biodata.alamatKota || "—"}. Melalui surat ini, saya mengajukan lamaran untuk posisi ${previewData.perusahaan.posisiLowongan || "—"} di ${previewData.perusahaan.jenisInstansi ? previewData.perusahaan.jenisInstansi + " " : ""}${previewData.perusahaan.namaPerusahaan || "—"}.`
          }) ],
          alignment: AlignmentType.JUSTIFIED,
          spacing: { after: 200 }
        }),

        // Tabel Data Pribadi
        new Paragraph({ text: "Data Pribadi:", spacing: { before: 120, after: 120 }, bold: true }),
        new Table({
          width: { size: 100, type: WidthType.PERCENTAGE },
          rows: [
            ...[
              ["Tempat/Tanggal Lahir", `${previewData.biodata.tempatLahir || "—"}, ${formatTanggalID(previewData.biodata.tanggalLahir)}`],
              ["Pendidikan", previewData.biodata.pendidikan],
              ["Status", previewData.biodata.status],
              ["Kontak", previewData.biodata.noHandphone],
              ["Email", previewData.biodata.email],
              ["Alamat", previewData.biodata.alamatLengkap],
            ].map(([k, v]) => new TableRow({
              children: [
                new TableCell({ children: [new Paragraph(k)] }),
                new TableCell({ children: [new Paragraph(":")], width: { size: 6, type: WidthType.PERCENTAGE } }),
                new TableCell({ children: [new Paragraph(v || "—")] }),
              ]
            }))
          ]
        }),

        new Paragraph({ text: `Sumber informasi: ${previewData.perusahaan.sumberLowongan || "—"}`, spacing: { before: 200, after: 120 } }),

        new Paragraph({ text: "Lampiran:", spacing: { after: 80 }, bold: true }),
        ...((previewData.perusahaan.lampiran?.length ? previewData.perusahaan.lampiran : ["—"]).map((item) =>
          new Paragraph({ text: `• ${item}`, spacing: { after: 40 } })
        )),

        new Paragraph({ text: "Saya siap untuk bergabung dan memberikan kontribusi terbaik.", alignment: AlignmentType.JUSTIFIED, spacing: { before: 160, after: 160 } }),
        new Paragraph({ text: "Terima kasih atas perhatiannya.", spacing: { after: 300 } }),

        new Paragraph({ text: "Hormat saya,", spacing: { after: 300 } }),
        new Paragraph({ text: previewData.biodata.namaLengkap || "—" }),
      ]
    }]
  })

  // Set default font & size 12pt
  doc.Styles.createParagraphStyle("Normal", "Normal")
    .basedOn("Normal")
    .font("Times New Roman")
    .size(24) // 12pt = 24 half-points

  const blob = await Packer.toBlob(doc)
  saveAs(blob, `Surat_Lamaran_${previewData.biodata.namaLengkap || "User"}.docx`)
}
```

---

## ✅ Checklist Visual

* [ ] Seluruh badan surat berada dalam **lebar A4** dengan **padding 25 mm** (terlihat kosong sekeliling).
* [ ] **Font 12 pt**, **line-height 1.5**, **justify** untuk semua paragraf.
* [ ] Jarak antar paragraf **~10 pt**, antar seksi **~14 pt**, jarak ke tanda tangan **~28 pt**.
* [ ] Tabel **Data Pribadi** memakai **3 kolom** dan **“:”** selalu berada di kolom tengah.
* [ ] **PDF** tajam (html2canvas scale ≥ 2).
* [ ] **DOCX** memiliki margin 25 mm, font 12 pt, paragraf justified, dan tabel rapi.
* [ ] Tidak ada tulisan terlalu kecil, tidak “lari” ke tepi halaman saat print.

---

