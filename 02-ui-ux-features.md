
# 02-ui-ux-features.md — Surat Lamaran Sederhana

## 🎯 Tujuan Tahap 2
Menambahkan semua **fungsi interaktif & export** pada halaman `/surat-lamaran-sederhana` yang sudah dibuat di tahap sebelumnya.

Target utama:
1. Membuat **ToolbarActions** (Copy / Print / Download PDF / Download Word / Reset)
2. Menyempurnakan **TemplatePicker** (dengan preview modal)
3. Menyempurnakan **UI & UX Layout** (mobile responsive + toast notifikasi)
4. Menyempurnakan persistensi form + toast notifikasi sukses
5. Optimasi performa (lazy import untuk html2pdf.js & docx)

---

## ⚙️ Komponen yang Ditambahkan / Diperbarui
### `/components/ToolbarActions.tsx`
Menampung semua tombol fungsi:
- **Copy**
- **Print**
- **Download PDF**
- **Download Word**
- **Reset**

### `/components/TemplatePicker.tsx`
Tambahkan tombol tambahan:
- Dropdown `Select`
- Tombol **“Lihat Semua Template”** → membuka Sheet/Dialog berisi 10 kartu template  
  (klik = ganti template aktif)

### `/components/PreviewSurat.tsx`
Tambahkan toolbar atas (sticky di mobile) dan area preview (dengan ID `preview-surat`).

---

## 💡 UI/UX Layout Final
### Struktur Umum Page
```tsx
<div className="grid lg:grid-cols-2 gap-6">
  <Card className="p-4 space-y-6">
    <Tabs defaultValue="biodata">
      <TabsList className="grid grid-cols-2 mb-4">
        <TabsTrigger value="biodata">Biodata</TabsTrigger>
        <TabsTrigger value="perusahaan">Data Lamaran</TabsTrigger>
      </TabsList>
      <TabsContent value="biodata"><FormBiodata /></TabsContent>
      <TabsContent value="perusahaan"><FormPerusahaan /></TabsContent>
    </Tabs>
  </Card>

  <Card className="p-4 flex flex-col gap-4">
    <TemplatePicker />
    <ToolbarActions />
    <PreviewSurat />
  </Card>
</div>
````

* Mobile → stack vertikal, dengan **ToolbarActions sticky di bawah layar.**
* PreviewSurat → gunakan `white-space: pre-wrap` agar baris tetap muncul.
* Tambahkan watermark kecil di bawah preview:
  `"Generated by JobMate - Surat Lamaran Sederhana"`

---

## 🧠 Komponen ToolbarActions.tsx

Gunakan shadcn/ui + ikon dari lucide-react.

Tombol:

| Tombol | Ikon       | Fungsi                           | Warna   |
| ------ | ---------- | -------------------------------- | ------- |
| Copy   | `Copy`     | Menyalin teks surat ke clipboard | default |
| Print  | `Printer`  | Cetak surat                      | default |
| PDF    | `FileDown` | Ekspor surat ke PDF              | teal    |
| Word   | `FileText` | Ekspor surat ke Word             | blue    |
| Reset  | `Trash2`   | Hapus semua data & localStorage  | red     |

---

## ⚙️ Fungsi Tombol

### 🧾 1️⃣ Copy

```ts
async function handleCopy(previewText: string) {
  await navigator.clipboard.writeText(previewText)
  toast.success("Surat lamaran berhasil disalin ke clipboard")
}
```

---

### 🖨️ 2️⃣ Print

```ts
function handlePrint() {
  window.print()
}
```

> Gunakan CSS `@media print` agar hanya area `#preview-surat` yang dicetak.

---

### 📄 3️⃣ Download PDF (html2pdf.js)

```ts
async function handleDownloadPDF() {
  const element = document.getElementById('preview-surat')
  if (!element) return toast.error("Preview belum tersedia")

  const html2pdf = (await import('html2pdf.js')).default
  const filename = `Surat_Lamaran_${form.biodata.namaLengkap || 'User'}.pdf`

  html2pdf().from(element).set({
    margin: 10,
    filename,
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  }).save()

  toast.success("PDF berhasil diunduh")
}
```

> Import **html2pdf.js** secara dinamis agar performa tetap ringan.

---

### 📘 4️⃣ Download Word (docx.js)

```ts
async function handleDownloadWord() {
  const { Document, Packer, Paragraph, TextRun } = await import('docx')
  const { saveAs } = await import('file-saver')
  const previewText = document.getElementById('preview-surat')?.innerText || ""
  if (!previewText) return toast.error("Tidak ada isi surat untuk diekspor")

  const doc = new Document({
    sections: [{
      children: [
        new Paragraph({ children: [new TextRun(previewText)] })
      ]
    }]
  })

  const blob = await Packer.toBlob(doc)
  const filename = `Surat_Lamaran_${form.biodata.namaLengkap || 'User'}.docx`
  saveAs(blob, filename)

  toast.success("File Word berhasil diunduh")
}
```

> Gunakan **lazy import docx & file-saver** agar tidak memperlambat initial load.

---

### 🧹 5️⃣ Reset

```ts
function handleReset() {
  if (confirm("Apakah Anda yakin ingin menghapus semua data?")) {
    localStorage.removeItem("jobmate_sls_form_v2")
    localStorage.removeItem("jobmate_sls_templateId_v2")
    window.location.reload()
  }
}
```

> Tampilkan toast sukses setelah reload jika ingin menambah UX.

---

## 🧭 Template Picker Enhancement

Tambahkan tombol **“Lihat Semua Template”** (gunakan `Sheet` atau `Dialog` dari shadcn/ui):

```tsx
<Sheet>
  <SheetTrigger asChild>
    <Button variant="outline">Lihat Semua Template</Button>
  </SheetTrigger>
  <SheetContent>
    <h3 className="font-bold mb-3">Daftar Template Surat</h3>
    <div className="space-y-3 overflow-y-auto max-h-[80vh]">
      {TEMPLATES.map((t) => (
        <Card key={t.id} onClick={() => selectTemplate(t.id)} className="cursor-pointer hover:bg-muted p-3">
          <h4 className="font-semibold">{t.title}</h4>
          <p className="text-sm text-muted-foreground line-clamp-3 whitespace-pre-wrap">
            {t.body.slice(0, 150)}...
          </p>
        </Card>
      ))}
    </div>
  </SheetContent>
</Sheet>
```

---

## 🧠 Toast & Feedback

Gunakan `useToast()` dari shadcn/ui untuk semua aksi:

* Copy → “Surat lamaran berhasil disalin”
* PDF → “PDF berhasil diunduh”
* Word → “File Word berhasil diunduh”
* Reset → “Data berhasil dihapus”

---

## 📱 Responsive Behaviour

* Desktop → 2 kolom: form kiri, preview kanan.
* Mobile → stack (form di atas, preview di bawah).
* ToolbarActions → sticky bottom pada mobile.
* Tombol besar & spacing luas (min-h-[44px]).

---

## 🧾 CSS Print

Tambahkan di global.css:

```css
@media print {
  body * {
    visibility: hidden !important;
  }
  #preview-surat, #preview-surat * {
    visibility: visible !important;
  }
  #preview-surat {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
  }
}
```

---

## 🧩 Optimasi Performa

* Import html2pdf, docx, file-saver **secara dinamis**.
* Jangan import langsung di bundle utama.
* Gunakan minimal 1s delay toast agar tidak tumpang tindih.
* Hindari rerender berat di PreviewSurat; gunakan memo atau debounced updates.

---

## 🧾 Acceptance Criteria Tahap 2

✅ Semua fitur tahap 1 tetap berfungsi
✅ ToolbarActions muncul dan semua tombol berfungsi:

* Copy → clipboard
* Print → hanya area surat
* PDF → download A4
* Word → download .docx
  ✅ Toast muncul di setiap aksi sukses
  ✅ TemplatePicker punya Sheet dengan 10 preview template
  ✅ Layout mobile & desktop nyaman digunakan
  ✅ Import library besar secara lazy
  ✅ Tidak ada error di console
  ✅ Halaman masih ringan (<200KB load)

---

## 💬 Catatan Pengujian

* Uji form + preview + export di Chrome & Edge.
* Tes mobile view dengan DevTools iPhone SE dan Pixel 7.
* Uji ulang persistensi setelah reload.
* Cek hasil PDF/Word: margin, newline, nama file benar.

---

## 🧩 Tahap Selanjutnya

Setelah tahap ini, lanjutkan ke **`03-templates.md`** untuk menambahkan isi lengkap 10 template surat lamaran di file `/lib/templates.ts`.

```
